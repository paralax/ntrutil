#!/bin/bash

if [ "-g" == "${1}" ]; then
    debug="-Xdebug -Xrunjdwp:transport=dt_socket,server=y,suspend=y,address=5005"
    shift 1
fi

ntrutil_home="$(dirname ${0})"/..
ntrutil_conf="${ntrutil_home}"/conf
ntrutil_lib="${ntrutil_home}"/lib

ntrutil_lib_escaped="$(/bin/echo "${ntrutil_lib}" | /usr/bin/sed 's/\//\\\//g')"

#
# Add all library dependencies to classpath.
#

cp="${ntrutil_lib}/$(/bin/ls "${ntrutil_lib}" | /usr/bin/tr '\n' ':')"
cp="$(/bin/echo ${cp} | /usr/bin/sed "s/:/:${ntrutil_lib_escaped}\//g")"

#
# Prepend configuration folder to classpath.
#

cp="${ntrutil_conf}:${cp}"

#
# Prepend development output folder to classpath.
#

cp="${ntrutil_home}/out/production/NtrUtil:${cp}"

#
# Execute the application.
#

java ${debug} -cp "${cp}" com.tagfoster.ntrutil.NtrUtil $*

exit $?
